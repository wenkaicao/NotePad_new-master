#  NotepadMaster ç¬”è®°åº”ç”¨

## ç®€ä»‹
NotepadMaster æ˜¯ä¸€æ¬¾åŸºäº Google Notepad Master å¼€å‘çš„å®‰å“ç¬”è®°åº”ç”¨ï¼Œæ—¨åœ¨å¸®åŠ©ç”¨æˆ·é«˜æ•ˆç®¡ç†ä¸ªäººç¬”è®°ã€‚åº”ç”¨ä¸»è¦æä¾›äº†ç¬”è®°çš„åŸºæœ¬ç®¡ç†åŠŸèƒ½ï¼ŒåŒ…æ‹¬è®°å½•ç¬”è®°æ—¶é—´æˆ³ã€æœç´¢åŠŸèƒ½ã€ç¬”è®°åˆ†ç±»å’Œæ ‡ç­¾ç®¡ç†ç­‰ï¼Œä¾¿äºç”¨æˆ·æŸ¥çœ‹å†å²è®°å½•å¹¶å¿«é€Ÿå®šä½éœ€è¦çš„ä¿¡æ¯ã€‚

## åŠŸèƒ½ç‰¹æ€§

### åŸºç¡€åŠŸèƒ½
- **æ—¶é—´æˆ³**ï¼šæ¯æ¬¡ä¿å­˜ç¬”è®°æ—¶è‡ªåŠ¨ç”Ÿæˆæ—¶é—´æˆ³ï¼Œæ–¹ä¾¿è®°å½•ç¬”è®°æ—¶é—´ã€‚
- **æœç´¢åŠŸèƒ½**ï¼šå¿«é€Ÿæœç´¢ç¬”è®°å†…å®¹ï¼Œå¸®åŠ©ä½ é«˜æ•ˆæ‰¾åˆ°æ‰€éœ€ä¿¡æ¯ã€‚

### é™„åŠ åŠŸèƒ½
- **UI ç¾åŒ–**ï¼šç®€æ´ä¸”ç¾è§‚çš„ç”¨æˆ·ç•Œé¢è®¾è®¡ï¼Œæä¾›èˆ’é€‚çš„ä½¿ç”¨ä½“éªŒã€‚
- **ç¬”è®°å†…å®¹å¯¼å‡º**ï¼šæ”¯æŒå°†ç¬”è®°å†…å®¹å¯¼å‡ºä¸ºæ–‡æœ¬æ–‡ä»¶ï¼Œä¾¿äºå¤‡ä»½å’Œåˆ†äº«ã€‚

## åŠŸèƒ½å®ç°
### â³ æ˜¾ç¤ºæ—¶é—´æˆ³
**åŠŸèƒ½æè¿°**
åº”ç”¨ä¼šè‡ªåŠ¨åœ¨æ¯æ¬¡ä¿å­˜ç¬”è®°æ—¶è®°å½•ä¿®æ”¹æ—¶é—´ã€‚æ—¶é—´æˆ³æ ¼å¼ä¸º yyyy-MM-dd HH:mmï¼Œä¾‹å¦‚ï¼š2024-12-01 14:30ï¼Œä»¥æ–¹ä¾¿è¿½è¸ªç¬”è®°çš„ä¿®æ”¹å†å²ã€‚
åœ¨ç¬”è®°åˆ—è¡¨ä¸­ï¼Œæ¯æ¡ç¬”è®°éƒ½ä¼šæ˜¾ç¤ºå®ƒçš„æœ€åä¿®æ”¹æ—¶é—´ï¼Œå¸®åŠ©ä½ å¿«é€ŸæŸ¥çœ‹æœ€æ–°çš„ç¬”è®°ã€‚

**å®ç°åŸç†**ï¼š  
   - è·å–å½“å‰æ—¶é—´æˆ³å¹¶æ ¼å¼åŒ–ä¸ºç”¨æˆ·å‹å¥½çš„æ—¥æœŸæ—¶é—´æ ¼å¼ã€‚  
   - ä½¿ç”¨ SQLite å­˜å‚¨ç¬”è®°å†…å®¹å’Œæ—¶é—´æˆ³ä¿¡æ¯ï¼Œå¹¶åœ¨ç¬”è®°åˆ—è¡¨ä¸­åŠ¨æ€åŠ è½½æ˜¾ç¤ºã€‚
   - 
**å®ç°ä»£ç **
    -ä¸»è¦æ˜¯å°†ä¿®æ”¹æ—¶é—´ä»sqliteæ•°æ®åº“ä¸­è¯»å–ï¼Œç„¶åæ˜ å°„åˆ°ç¬”è®°ä¸­ï¼Œè¿™é‡Œåªå±•ç¤ºè·å–æ—¶é—´æˆ³å’Œè½¬æ¢æ—¶é—´æ ¼å¼çš„ä»£ç ã€‚
     
     å¸ƒå±€æ–‡ä»¶ä¸­å±•ç¤ºæ—¶é—´æˆ³çš„TextViewï¼š
     

     <TextView
        android:id="@android:id/text2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:layout_gravity="center_vertical"
        android:textColor="#BBBBBB"
        android:textSize="15sp"
        android:paddingLeft="5dp"
        android:singleLine="true"/>

ä¸ºäº†å°†æ—¶é—´æˆ³ä»¥å‹å¥½çš„æ ¼å¼æ˜¾ç¤ºï¼Œéœ€è¦è¿›è¡Œè‡ªå®šä¹‰ç»‘å®šã€‚åœ¨è¿™é‡Œï¼Œä½¿ç”¨äº† SimpleCursorAdapter å°†æ•°æ®åº“ä¸­çš„åˆ—æ˜ å°„åˆ°è§†å›¾ä¸Šçš„å¯¹åº”ä½ç½®ï¼š
``` java
String[] dataColumns = {
    NotePad.Notes.COLUMN_NAME_TITLE,              // æ ‡é¢˜
    NotePad.Notes.COLUMN_NAME_MODIFICATION_DATE,  // ä¿®æ”¹æ—¶é—´
    NotePad.Notes.COLUMN_NAME_NOTE                // å†…å®¹
};
int[] viewIDs = {
    android.R.id.text1,    // æ˜ å°„æ ‡é¢˜
    android.R.id.text2,    // æ˜ å°„ä¿®æ”¹æ—¶é—´
    R.id.content           // æ˜ å°„å†…å®¹
};
 ```
å°† SimpleCursorAdapter ç»‘å®šåˆ° ListView åï¼Œé€šè¿‡ setViewBinder æ–¹æ³•å®ç°è‡ªå®šä¹‰æ˜¾ç¤ºä¿®æ”¹æ—¶é—´çš„é€»è¾‘ï¼š
``` java
adapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
    @Override
    public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
        if (columnIndex == cursor.getColumnIndex(NotePad.Notes.COLUMN_NAME_MODIFICATION_DATE)) {
            long timestamp = cursor.getLong(columnIndex); // ä»æ¸¸æ ‡è·å–æ—¶é—´æˆ³
            String formattedDate = formatDate(timestamp); // è°ƒç”¨æ ¼å¼åŒ–æ–¹æ³•
            TextView textView = (TextView) view;
            textView.setText(formattedDate); // è®¾ç½®æ˜¾ç¤ºæ ¼å¼åŒ–åçš„æ—¥æœŸ

            return true; // è¡¨ç¤ºè¯¥åˆ—å·²å¤„ç†
        }
        return false; // å¯¹å…¶ä»–åˆ—ä¸åšå¤„ç†
    }
});
```
 æ ¼å¼åŒ–æ—¶é—´æˆ³
åœ¨ setViewBinder() ä¸­ï¼Œè°ƒç”¨ formatDate() æ–¹æ³•å°†æ—¶é—´æˆ³è½¬æ¢ä¸ºæ˜“è¯»çš„æ—¥æœŸæ ¼å¼ï¼š

``` java
private String formatDate(long timestamp) {
    // åˆ›å»ºä¸€ä¸ªæ—¥æœŸæ ¼å¼åŒ–å™¨ï¼ŒæŒ‡å®šæ ¼å¼ä¸º yyyy-MM-dd HH:mm
    SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd HH:mm", Locale.getDefault());
    // å°†æ—¶é—´æˆ³è½¬æ¢ä¸º Date å¯¹è±¡ï¼Œå¹¶æ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²
    return dateFormat.format(new Date(timestamp));
}
```
**åŠŸèƒ½æˆªå›¾**

![image](https://github.com/user-attachments/assets/82ec2449-e4a0-4584-b126-5a9f5ebaeb69)

---------------------------------------------------------------------------------------------------------


### ğŸ” æœç´¢åŠŸèƒ½
**åŠŸèƒ½æè¿°**
      åœ¨ä¸»ç•Œé¢ä¸­ï¼Œç‚¹å‡»æœç´¢æŒ‰é’®ï¼Œè¾“å…¥å…³é”®å­—å³å¯æ£€ç´¢ç¬”è®°æ ‡é¢˜ã€‚æ”¯æŒæ¨¡ç³ŠæŸ¥è¯¢åŠŸèƒ½ï¼Œæ— éœ€è¾“å…¥å®Œæ•´æ ‡é¢˜å³å¯æ‰¾åˆ°ç›¸å…³ç¬”è®°ï¼Œé€‚åˆå¤§é‡ç¬”è®°ç®¡ç†ã€‚

   **å®ç°åŸç†**ï¼š  
   - åœ¨ SQLite ä¸­ä½¿ç”¨ `LIKE` è¯­å¥è¿›è¡Œå…³é”®å­—åŒ¹é…æŸ¥è¯¢ã€‚  
   - æœç´¢ç»“æœä¼šå®æ—¶æ›´æ–°ï¼Œå¹¶é€šè¿‡ Cursor åŠ è½½æ•°æ®åˆ° UI å±‚å±•ç¤ºã€‚
     
**ä»£ç å®ç°**
1. #### ä¼ é€’æœç´¢æŸ¥è¯¢å‚æ•°
æœç´¢æŸ¥è¯¢çš„è§¦å‘æ¥è‡ª onOptionsItemSelected æ–¹æ³•ä¸­çš„ "æœç´¢" é€‰é¡¹ã€‚ç‚¹å‡»è¿™ä¸ªé€‰é¡¹æ—¶ï¼Œä¼šå¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œè®©ç”¨æˆ·è¾“å…¥æœç´¢å…³é”®å­—ã€‚

ä»£ç æ®µï¼šæœç´¢åŠŸèƒ½è§¦å‘
``` java
case R.id.menu_search:
    AlertDialog.Builder builder = new AlertDialog.Builder(this);
    builder.setTitle("æœç´¢ç¬”è®°");

    final EditText input = new EditText(this);
    builder.setView(input);

    builder.setPositiveButton("æœç´¢", new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog, int which) {
            String searchQuery = input.getText().toString().trim();
            if (!searchQuery.isEmpty()) {
                Intent intent = new Intent(NotesList.this, NotesList.class);
                intent.putExtra("searchQuery", searchQuery); // å°†æœç´¢å†…å®¹ä¼ é€’ç»™NotesList
                startActivity(intent);
            } else {
                Toast.makeText(NotesList.this, "è¯·è¾“å…¥æœç´¢å†…å®¹", Toast.LENGTH_SHORT).show();
            }
        }
    });
    builder.setNegativeButton("å–æ¶ˆ", null);
    // æ˜¾ç¤ºå¯¹è¯æ¡†
    builder.show();
    return true;
```
å½“ç‚¹å‡»æœç´¢èœå•é¡¹æ—¶ï¼ŒAlertDialog å¼¹å‡ºä¸€ä¸ªè¾“å…¥æ¡†ï¼Œè®©ç”¨æˆ·è¾“å…¥æœç´¢å…³é”®å­—ã€‚
ç”¨æˆ·è¾“å…¥çš„å†…å®¹é€šè¿‡ input.getText().toString().trim() è·å–å¹¶å­˜å‚¨åˆ° searchQuery å˜é‡ä¸­ã€‚
å¦‚æœç”¨æˆ·è¾“å…¥çš„å†…å®¹éç©ºï¼Œåˆ™é€šè¿‡ Intent å°† searchQuery ä¼ é€’åˆ° NotesList ç±»ï¼Œå¯åŠ¨ä¸€ä¸ªæ–°çš„ NotesList æ´»åŠ¨å¹¶æ‰§è¡Œæœç´¢æ“ä½œã€‚
å¦‚æœæ²¡æœ‰è¾“å…¥å†…å®¹ï¼Œæ˜¾ç¤ºä¸€ä¸ª Toast æç¤ºï¼Œè¦æ±‚ç”¨æˆ·è¾“å…¥æœç´¢å†…å®¹ã€‚

2. #### æ ¹æ®æœç´¢æ¡ä»¶ç­›é€‰æ•°æ®åº“è®°å½•
åœ¨ NotesList çš„ onCreate æ–¹æ³•ä¸­ï¼Œé€šè¿‡æ£€æŸ¥ Intent æ˜¯å¦åŒ…å«æœç´¢æŸ¥è¯¢ï¼ˆsearchQueryï¼‰ï¼Œå¦‚æœåŒ…å«æœç´¢å†…å®¹ï¼Œåˆ™æ ¹æ®è¯¥å†…å®¹åœ¨æ•°æ®åº“ä¸­ç­›é€‰æ ‡é¢˜è¿›è¡Œæœç´¢ã€‚
ä»£ç æ®µï¼šæ‰§è¡ŒæŸ¥è¯¢å¹¶æ ¹æ®æ ‡é¢˜è¿›è¡Œè¿‡æ»¤
``` java
String searchQuery = getIntent().getStringExtra("searchQuery");

if (searchQuery != null && !searchQuery.isEmpty()) {
    selection = NotePad.Notes.COLUMN_NAME_TITLE + " LIKE ?"; // æ ¹æ®æ ‡é¢˜è¿‡æ»¤
    selectionArgs = new String[]{"%" + searchQuery + "%"}; // æœç´¢å…³é”®å­—
}

```
getIntent().getStringExtra("searchQuery") è·å–ä¼ é€’è¿‡æ¥çš„ searchQuery å‚æ•°ã€‚
å¦‚æœ searchQuery éç©ºï¼Œåˆ™è®¾ç½® selection ä¸º "COLUMN_NAME_TITLE LIKE ?"ï¼Œå³ SQL çš„ WHERE å­å¥ï¼Œé€šè¿‡æ ‡é¢˜è¿›è¡Œæ¨¡ç³ŠåŒ¹é…ã€‚
selectionArgs è®¾ç½®ä¸º {"%" + searchQuery + "%"}ï¼Œè¿™é‡Œçš„ % æ˜¯ SQL ä¸­çš„é€šé…ç¬¦ï¼Œè¡¨ç¤ºæ ‡é¢˜ä¸­å¯ä»¥åŒ…å«æœç´¢å…³é”®å­—çš„ä»»ä½•ä½ç½®ã€‚

3. #### æ‰§è¡ŒæŸ¥è¯¢å¹¶ç»‘å®šæ•°æ®
æ¥ä¸‹æ¥ï¼Œä½¿ç”¨ managedQuery() æ–¹æ³•æ‰§è¡ŒæŸ¥è¯¢ï¼Œå¹¶æ ¹æ®ä¼ å…¥çš„ selection å’Œ selectionArgs è¿‡æ»¤æ•°æ®ã€‚
ä»£ç æ®µï¼šæ‰§è¡ŒæŸ¥è¯¢
``` java
Cursor cursor = managedQuery(
    getIntent().getData(),                // ä½¿ç”¨é»˜è®¤å†…å®¹URI
    PROJECTION,                           // è¿”å›çš„åˆ—
    selection,                            // è®¾ç½®ç­›é€‰æ¡ä»¶
    selectionArgs,                        // è®¾ç½®ç­›é€‰æ¡ä»¶çš„å‚æ•°
    NotePad.Notes.DEFAULT_SORT_ORDER      // é»˜è®¤æ’åº
);

```
getIntent().getData() è¿”å›æŸ¥è¯¢çš„ URIï¼Œé€šå¸¸æ˜¯ NotePad.Notes.CONTENT_URIã€‚
PROJECTION æ˜¯è¿”å›çš„åˆ—ï¼Œè¿™é‡ŒåŒ…å«äº†ç¬”è®°çš„ IDã€æ ‡é¢˜ã€ä¿®æ”¹æ—¶é—´ å’Œ å†…å®¹ã€‚
selection å’Œ selectionArgs æ˜¯è¿‡æ»¤æ¡ä»¶ï¼Œselection æŒ‡å®šäº†æ ¹æ®æ ‡é¢˜è¿›è¡Œæ¨¡ç³ŠåŒ¹é…ã€‚
NotePad.Notes.DEFAULT_SORT_ORDER æ˜¯é»˜è®¤çš„æ’åºé¡ºåºï¼Œé€šå¸¸æ˜¯æŒ‰æ—¶é—´æ’åºã€‚
æŸ¥è¯¢å®Œæˆåï¼Œç»“æœä¼šå­˜å‚¨åœ¨ Cursor ä¸­ï¼Œå¹¶é€šè¿‡ SimpleCursorAdapter å°†å…¶ç»‘å®šåˆ° ListView ä¸­ã€‚

ä»£ç æ®µï¼šè®¾ç½®é€‚é…å™¨å’Œè§†å›¾
```java
SimpleCursorAdapter adapter = new SimpleCursorAdapter(
    this,
    R.layout.noteslist_item,
    cursor,
    dataColumns,
    viewIDs
);
```

é€šè¿‡ SimpleCursorAdapterï¼ŒæŸ¥è¯¢ç»“æœï¼ˆcursorï¼‰ä¸­çš„æ¯ä¸€è¡Œæ•°æ®ä¼šæ˜ å°„åˆ° noteslist_item å¸ƒå±€æ–‡ä»¶ä¸­çš„æ§ä»¶ï¼ˆå¦‚æ ‡é¢˜ã€ä¿®æ”¹æ—¶é—´ã€å†…å®¹ç­‰ï¼‰ã€‚æœç´¢ç»“æœä¼šå®æ—¶æ›´æ–°å¹¶æ˜¾ç¤ºåœ¨åˆ—è¡¨ä¸­ã€‚
åŒæ—¶ï¼Œè¯¥æœç´¢åŠŸèƒ½æ”¯æŒæ¨¡ç³Šæœç´¢ã€‚
**åŠŸèƒ½æˆªå›¾**

![image](https://github.com/user-attachments/assets/e53763e1-2117-49fd-8672-130311a17709)![image](https://github.com/user-attachments/assets/594d9da0-8b2b-4fe7-a0f3-71e1dbf13def)


--------------------------------------------------------------------------------------------

### UIç¾åŒ–
#### å†…å®¹æ˜ å°„è‡³ç¬”è®°ä¸Š
**åŠŸèƒ½æè¿°**
èƒ½å¤Ÿåœ¨ç¬”è®°é¦–é¡µæµè§ˆåˆ°ç¬”è®°å†…å®¹å¼€å¤´

**å®ç°åŸç†**
1ã€å…ˆåœ¨å¸ƒå±€æ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªTextViewå‘ˆç°å†…å®¹ã€‚
2ã€ä»contentProviderè·å–å†…å®¹ã€‚
3ã€å°†å†…å®¹æ˜ å°„åˆ°ç•Œé¢ä¸­ã€‚

**ä»£ç å®ç°**
å±•ç¤ºå†…å®¹çš„TextViewç»„ä»¶ï¼Œè¯¥æ§ä»¶å°†ä¼šç”¨äºæ˜¾ç¤º COLUMN_NAME_NOTE ä¸­çš„ç¬”è®°å†…å®¹ã€‚
<TextView
            android:id="@+id/content"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:textAppearance="?android:attr/textAppearanceLarge"
            android:gravity="center_vertical"
            android:textColor="#AAAAAA"
            android:textSize="15dp"
            android:paddingLeft="5dip"
            android:singleLine="true"/>

 SimpleCursorAdapter ä¸­çš„æ˜ å°„
æ¥ç€ï¼Œåœ¨ NotesList Activity ä¸­ï¼Œé€šè¿‡ SimpleCursorAdapter æ¥ç»‘å®šæ•°æ®ã€‚åœ¨è¿™æ®µä»£ç ä¸­ï¼ŒSimpleCursorAdapter çš„æ„é€ å‡½æ•°å°†æŸ¥è¯¢ç»“æœï¼ˆå³ç¬”è®°çš„å†…å®¹ï¼‰æ˜ å°„åˆ°ç›¸åº”çš„è§†å›¾æ§ä»¶ï¼š
```java
   SimpleCursorAdapter adapter = new SimpleCursorAdapter(
    this,
    R.layout.noteslist_item, // ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„å¸ƒå±€
    cursor,                  // ä»æ•°æ®åº“æŸ¥è¯¢åˆ°çš„ Cursor å¯¹è±¡
    dataColumns,             // æ˜ å°„çš„åˆ—ï¼šæ ‡é¢˜ã€ä¿®æ”¹æ—¶é—´å’Œå†…å®¹
    viewIDs                  // æ˜ å°„åˆ°çš„è§†å›¾æ§ä»¶çš„ ID
);
```
dataColumns æ•°ç»„ä¸­åŒ…å«äº† COLUMN_NAME_NOTEï¼Œå³ç¬”è®°çš„å†…å®¹åˆ—ï¼Œå®ƒè¢«æ˜ å°„åˆ° viewIDs æ•°ç»„ä¸­çš„ R.id.contentï¼Œå³ä¸Šé¢å¸ƒå±€æ–‡ä»¶ä¸­å®šä¹‰çš„ TextView æ§ä»¶ã€‚

```java
String[] dataColumns = {
    NotePad.Notes.COLUMN_NAME_TITLE,             // æ˜ å°„æ ‡é¢˜
    NotePad.Notes.COLUMN_NAME_MODIFICATION_DATE, // æ˜ å°„ä¿®æ”¹æ—¶é—´
    NotePad.Notes.COLUMN_NAME_NOTE               // æ˜ å°„ç¬”è®°å†…å®¹
};

int[] viewIDs = {
    android.R.id.text1,       // æ˜ å°„æ ‡é¢˜åˆ° text1
    android.R.id.text2,       // æ˜ å°„ä¿®æ”¹æ—¶é—´åˆ° text2
    R.id.content              // æ˜ å°„ç¬”è®°å†…å®¹åˆ°è‡ªå®šä¹‰æ§ä»¶ content
};
```
NotePad.Notes.COLUMN_NAME_NOTE æ˜¯æ•°æ®åº“ä¸­çš„ç¬”è®°å†…å®¹åˆ—ï¼Œå®ƒä¼šè¢«æ˜ å°„åˆ° R.id.contentï¼ˆå³å¸ƒå±€æ–‡ä»¶ä¸­å®šä¹‰çš„ TextViewï¼‰ä¸­ï¼Œä»è€Œæ˜¾ç¤ºç¬”è®°å†…å®¹ã€‚
å¦‚ä½•æ˜¾ç¤ºæ•°æ®ï¼š
å½“ SimpleCursorAdapter è®¾ç½®å®Œä¹‹åï¼Œå®ƒä¼šè‡ªåŠ¨å¤„ç†æŸ¥è¯¢ç»“æœï¼Œå¹¶å°†æ¯ä¸€è¡Œæ•°æ®ç»‘å®šåˆ°å¯¹åº”çš„è§†å›¾æ§ä»¶ã€‚
å¯¹äº COLUMN_NAME_NOTEï¼Œå®ƒä¼šå°†æŸ¥è¯¢ç»“æœä¸­æ¯ä¸€è¡Œçš„ç¬”è®°å†…å®¹ï¼ˆå³ NotePad.Notes.COLUMN_NAME_NOTEï¼‰ç»‘å®šåˆ°å¸ƒå±€ä¸­ R.id.content æ§ä»¶ä¸­ï¼Œå±•ç¤ºåœ¨ UI ä¸Šã€‚
**åŠŸèƒ½æˆªå›¾**

![image](https://github.com/user-attachments/assets/68c6e040-1a55-409c-a7fd-0436e4d3ad35)

------------------------------------------------------------------------------------------

#### æ›´æ”¹ç¬”è®°èƒŒæ™¯

**åŠŸèƒ½æè¿°**
åœ¨ç¬”è®°ç•Œé¢ä¸­ï¼Œå¯ä»¥é€‰æ‹©æ›´æ”¹ç¬”è®°èƒŒæ™¯

**ä»£ç å®ç°**
èƒŒæ™¯æ›´æ”¹çš„æŒ‰é’®è¢«æ”¾åœ¨ç¬”è®°çš„èœå•ä¸­ï¼š
```
<item android:id="@+id/menu_background"
          android:icon="@drawable/ic_menu_edit"
          android:title="background"/>
 ```
![image](https://github.com/user-attachments/assets/ccc532a3-f729-457e-a5c7-4235efd8d015)


1. å±•ç¤ºèƒŒæ™¯é€‰æ‹©å¯¹è¯æ¡†
èƒŒæ™¯é€‰æ‹©å¯¹è¯æ¡†è®©ç”¨æˆ·é€‰æ‹©èƒŒæ™¯å›¾ç‰‡ï¼Œå¹¶æ›´æ–°ç¬”è®°ç¼–è¾‘ç•Œé¢çš„èƒŒæ™¯ã€‚ç›¸å…³çš„ä»£ç éƒ¨åˆ†åœ¨ showBackgroundImagePickerDialog() æ–¹æ³•ä¸­
``` java
private void showBackgroundImagePickerDialog() {
    // å®šä¹‰å¯ä¾›é€‰æ‹©çš„èƒŒæ™¯å›¾ç‰‡èµ„æº ID æ•°ç»„
    final int[] imageResIds = {
        R.drawable.ic_background_back1,
        R.drawable.ic_background_back2,
        R.drawable.ic_background_back3
    };

    // å®šä¹‰èƒŒæ™¯å›¾ç‰‡åç§°æ•°ç»„
    final String[] imageNames = {"ç«¹", "æ¹–", "æ™¯"};

    // åˆ›å»ºå¯¹è¯æ¡†
    AlertDialog.Builder builder = new AlertDialog.Builder(this);
    builder.setTitle("Choose Background Image");

    // è®¾ç½®å¯¹è¯æ¡†é€‰é¡¹å’Œç‚¹å‡»äº‹ä»¶
    builder.setItems(imageNames, new DialogInterface.OnClickListener() {
        @Override
        public void onClick(DialogInterface dialog, int which) {
            // æ ¹æ®ç”¨æˆ·é€‰æ‹©çš„å›¾ç‰‡æ›´æ–°èƒŒæ™¯
            int selectedResId = imageResIds[which];
            mText.setBackgroundResource(selectedResId);

            // ä¿å­˜ç”¨æˆ·é€‰æ‹©çš„èƒŒæ™¯èµ„æº ID åˆ° SharedPreferences
            SharedPreferences preferences = getSharedPreferences("NoteEditorPrefs", MODE_PRIVATE);
            SharedPreferences.Editor editor = preferences.edit();
            editor.putInt("backgroundResId", selectedResId);
            editor.apply(); // ä¿å­˜èƒŒæ™¯èµ„æºè®¾ç½®
        }
    });

    // æ˜¾ç¤ºå¯¹è¯æ¡†
    builder.show();
}
```

2. ä¿å­˜èƒŒæ™¯èµ„æº ID
ç”¨æˆ·é€‰æ‹©çš„èƒŒæ™¯å›¾ç‰‡ä¼šè¢«ä¿å­˜åˆ° SharedPreferencesï¼Œä»¥ä¾¿åº”ç”¨é‡å¯æ—¶å¯ä»¥æ¢å¤è¯¥è®¾ç½®ã€‚åœ¨ onPause() å’Œ showBackgroundImagePickerDialog() æ–¹æ³•ä¸­éƒ½æœ‰ä¿å­˜èƒŒæ™¯èµ„æº ID çš„é€»è¾‘ï¼š
``` java
// ä¿å­˜èƒŒæ™¯èµ„æº ID
int backgroundResId = (Integer) mText.getTag();
SharedPreferences preferences = getSharedPreferences("NoteEditorPrefs", MODE_PRIVATE);
SharedPreferences.Editor editor = preferences.edit();
editor.putInt("backgroundResId", backgroundResId);
editor.apply();  // ä¿å­˜èƒŒæ™¯è®¾ç½®
```
putInt()ï¼šå°†èƒŒæ™¯èµ„æº ID å­˜å‚¨åˆ° SharedPreferences ä¸­ï¼Œé”®åä¸º "backgroundResId"ã€‚

3. æ¢å¤èƒŒæ™¯è®¾ç½®
å½“åº”ç”¨å†æ¬¡å¯åŠ¨æˆ–ç¬”è®°ç•Œé¢æ¢å¤æ—¶ï¼Œé€šè¿‡ onCreate() å’Œ onResume() æ–¹æ³•ä» SharedPreferences ä¸­è·å–ä¹‹å‰ä¿å­˜çš„èƒŒæ™¯èµ„æº IDï¼Œå¹¶é‡æ–°è®¾ç½®èƒŒæ™¯ï¼š
``` java
SharedPreferences preferences = getSharedPreferences("NoteEditorPrefs", MODE_PRIVATE);
int backgroundResId = preferences.getInt("backgroundResId", -1); // é»˜è®¤å€¼ä¸º -1
if (backgroundResId != -1) {
    mText.setBackgroundResource(backgroundResId);
    mText.setTag(backgroundResId);  // æ¢å¤èƒŒæ™¯èµ„æº ID
}
```
getInt()ï¼šä» SharedPreferences ä¸­è¯»å–å­˜å‚¨çš„èƒŒæ™¯èµ„æº IDã€‚å¦‚æœè¯»å–åˆ°çš„èƒŒæ™¯èµ„æº ID ä¸ä¸ºé»˜è®¤å€¼ -1ï¼Œåˆ™è°ƒç”¨ mText.setBackgroundResource() æ–¹æ³•é‡æ–°è®¾ç½®èƒŒæ™¯ã€‚
setTag()ï¼šä¸ºäº†åœ¨å…¶ä»–åœ°æ–¹æ–¹ä¾¿å­˜å–èƒŒæ™¯èµ„æº IDï¼ŒèƒŒæ™¯èµ„æº ID è¢«å­˜å‚¨åœ¨ EditText çš„ Tag ä¸­ã€‚

4. ä¿å­˜å’Œæ¢å¤å®ä¾‹çŠ¶æ€
å¦‚æœåº”ç”¨å› ç³»ç»ŸçŠ¶æ€å˜åŒ–ï¼ˆå¦‚å±å¹•æ—‹è½¬ï¼‰è€Œé”€æ¯ï¼Œç³»ç»Ÿä¼šè°ƒç”¨ onSaveInstanceState() ä¿å­˜å½“å‰èƒŒæ™¯è®¾ç½®ï¼Œå¹¶åœ¨ onRestoreInstanceState() æ¢å¤ï¼š
``` java
@Override
protected void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);
    int backgroundResId = (Integer) mText.getTag();  // å­˜å‚¨èƒŒæ™¯èµ„æºçš„ ID åœ¨ Tag ä¸­
    outState.putInt("backgroundResId", backgroundResId);
}

@Override
protected void onRestoreInstanceState(Bundle savedInstanceState) {
    super.onRestoreInstanceState(savedInstanceState);
    if (savedInstanceState != null) {
        // æ¢å¤èƒŒæ™¯èµ„æº ID
        int backgroundResId = savedInstanceState.getInt("backgroundResId", -1);
        if (backgroundResId != -1) {
            mText.setBackgroundResource(backgroundResId);
            mText.setTag(backgroundResId);  // æ¢å¤èƒŒæ™¯èµ„æº ID
        }
    }
}
```

***åŠŸèƒ½æˆªå›¾***

![image](https://github.com/user-attachments/assets/522c5c05-946f-4e7f-be01-037eabaebb86)

é€‰æ‹©ç¬¬äºŒä¸ªæ¹–çš„èƒŒæ™¯

![image](https://github.com/user-attachments/assets/0f3390d6-cde4-4c4d-a0f2-b24e59d70055)

---------------------------------------------------------------------------------------

### æ–‡ä»¶å¯¼å‡º

**åŠŸèƒ½æè¿°**
åœ¨ç¬”è®°èœå•ä¸­é€‰æ‹©exportåŠŸèƒ½ï¼Œç¬”è®°å°†ä¼šè¢«ä»¥.txtæ–‡ä»¶çš„å½¢å¼å¯¼å‡ºè‡³storage/downloadä¸‹

**ä»£ç å®ç°**
å¯¼å‡ºåŠŸèƒ½çš„ç»„ä»¶åŒæ ·è¢«æ”¾åœ¨ç¬”è®°çš„èœå•ä¸­ï¼š
```
<item android:id="@+id/menu_export"
          android:icon="@drawable/ic_menu_edit"
          android:title="export"/>
```

![image](https://github.com/user-attachments/assets/01de6ff3-3451-492f-86b6-1c10f0af7328)


1. æ–‡ä»¶å¯¼å‡ºåŠŸèƒ½çš„è§¦å‘ï¼š
å¯¼å‡ºåŠŸèƒ½é€šè¿‡ menu_export é€‰é¡¹åœ¨èœå•ä¸­è§¦å‘
``` java
case R.id.menu_export:
    export();
    break;
```
å½“ç”¨æˆ·é€‰æ‹©â€œå¯¼å‡ºâ€èœå•é¡¹æ—¶ï¼Œè°ƒç”¨äº† export() æ–¹æ³•ã€‚

2. export() æ–¹æ³•ï¼š
export() æ–¹æ³•å±•ç¤ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œæç¤ºç”¨æˆ·è¾“å…¥æ–‡ä»¶åï¼š
``` java
private void export() {
    final EditText input = new EditText(this);
    input.setHint("è¯·è¾“å…¥æ–‡ä»¶å");

    AlertDialog dialog = new AlertDialog.Builder(this)
            .setTitle("å¯¼å‡ºç¬”è®°")
            .setView(input)
            .setPositiveButton("ç¡®å®š", new DialogInterface.OnClickListener() {
                @Override
                public void onClick(DialogInterface dialogInterface, int which) {
                    String fileName = input.getText().toString().trim();
                    if (fileName.isEmpty()) {
                        Toast.makeText(NoteEditor.this, "æ–‡ä»¶åä¸èƒ½ä¸ºç©º", Toast.LENGTH_SHORT).show();
                    } else {
                        // å¯åŠ¨æ–‡ä»¶é€‰æ‹©å™¨
                        openFilePicker(fileName);
                    }
                }
            })
            .setNegativeButton("å–æ¶ˆ", null)
            .create();
    dialog.show();
    dialog.getButton(AlertDialog.BUTTON_POSITIVE).setTextColor(Color.BLACK);
}
```
é¦–å…ˆï¼ŒEditText ç»„ä»¶è®©ç”¨æˆ·è¾“å…¥æ–‡ä»¶åã€‚
å¦‚æœç”¨æˆ·ç‚¹å‡»â€œç¡®å®šâ€ï¼Œç³»ç»Ÿä¼šæ£€æŸ¥æ–‡ä»¶åæ˜¯å¦ä¸ºç©ºã€‚å¦‚æœä¸ºç©ºï¼Œæç¤ºé”™è¯¯ä¿¡æ¯ï¼›å¦åˆ™ï¼Œè°ƒç”¨ openFilePicker(fileName) æ–¹æ³•æ¥å¯åŠ¨æ–‡ä»¶é€‰æ‹©å™¨ï¼Œè®©ç”¨æˆ·é€‰æ‹©ä¿å­˜æ–‡ä»¶çš„è·¯å¾„ã€‚

3. æ‰“å¼€æ–‡ä»¶é€‰æ‹©å™¨ï¼šopenFilePicker(fileName) æ–¹æ³•ï¼š
è¯¥æ–¹æ³•ä½¿ç”¨ Intent.ACTION_CREATE_DOCUMENT å¯åŠ¨ç³»ç»Ÿçš„æ–‡ä»¶é€‰æ‹©å™¨ï¼Œå¹¶å…è®¸ç”¨æˆ·åˆ›å»ºæ–°çš„æ–‡æœ¬æ–‡ä»¶ï¼š
``` java
private void openFilePicker(String fileName) {
    Intent intent = new Intent(Intent.ACTION_CREATE_DOCUMENT);
    intent.addCategory(Intent.CATEGORY_OPENABLE);
    intent.setType("text/plain");
    intent.putExtra(Intent.EXTRA_TITLE, fileName + ".txt"); // ç”¨æˆ·è¾“å…¥çš„æ–‡ä»¶å
    startActivityForResult(intent, REQUEST_CODE_EXPORT);
}
```
è¿™ä¸ª Intent ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡æ¡£ï¼Œæ–‡ä»¶ç±»å‹ä¸ºçº¯æ–‡æœ¬ (text/plain)ã€‚
æ–‡ä»¶åæ¥è‡ªç”¨æˆ·è¾“å…¥ï¼Œåç¼€ä¸º .txtã€‚
startActivityForResult() å¯åŠ¨æ–‡ä»¶é€‰æ‹©å™¨ï¼Œå¹¶ç­‰å¾…ç”¨æˆ·é€‰æ‹©ä½ç½®åè¿”å›ç»“æœã€‚

4. å¤„ç†æ–‡ä»¶é€‰æ‹©ç»“æœï¼š
å½“ç”¨æˆ·åœ¨æ–‡ä»¶é€‰æ‹©å™¨ä¸­é€‰æ‹©äº†ä¿å­˜ä½ç½®ï¼Œç³»ç»Ÿå°†è°ƒç”¨ onActivityResult() æ–¹æ³•
``` java
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);

    if (requestCode == REQUEST_CODE_EXPORT && resultCode == RESULT_OK) {
        Uri fileUri = data.getData();

        if (fileUri != null) {
            saveNoteToFile(fileUri);
        } else {
            Toast.makeText(this, "æ–‡ä»¶åˆ›å»ºå¤±è´¥", Toast.LENGTH_SHORT).show();
        }
    }
}
```
é¦–å…ˆæ£€æŸ¥ requestCode æ˜¯å¦ä¸ºå¯¼å‡ºæ–‡ä»¶çš„è¯·æ±‚ç  (REQUEST_CODE_EXPORT)ã€‚
å¦‚æœç»“æœæ˜¯ RESULT_OKï¼Œåˆ™ä» data ä¸­è·å–ä¿å­˜çš„æ–‡ä»¶ Uriï¼Œç„¶åè°ƒç”¨ saveNoteToFile(fileUri) æ–¹æ³•å°†ç¬”è®°å†…å®¹å†™å…¥æ–‡ä»¶ã€‚

5. ä¿å­˜ç¬”è®°å†…å®¹åˆ°æ–‡ä»¶ï¼šsaveNoteToFile() æ–¹æ³•ï¼š
``` java
private void saveNoteToFile(Uri fileUri) {
    try {
        // è·å–ç¬”è®°å†…å®¹
        String noteContent = mText.getText().toString();

        // æ‰“å¼€è¾“å‡ºæµå¹¶å†™å…¥æ•°æ®
        try (OutputStream outputStream = getContentResolver().openOutputStream(fileUri)) {
            if (outputStream != null) {
                outputStream.write(noteContent.getBytes());
                outputStream.flush();
                Toast.makeText(this, "ç¬”è®°å¯¼å‡ºæˆåŠŸ", Toast.LENGTH_SHORT).show();
            } else {
                Toast.makeText(this, "æ— æ³•æ‰“å¼€æ–‡ä»¶", Toast.LENGTH_SHORT).show();
            }
        }
    } catch (Exception e) {
        e.printStackTrace();
        Toast.makeText(this, "å¯¼å‡ºå¤±è´¥ï¼š" + e.getMessage(), Toast.LENGTH_SHORT).show();
    }
}
```
è¯¥æ–¹æ³•é€šè¿‡ fileUri æ‰“å¼€ä¸€ä¸ªè¾“å‡ºæµã€‚
ç„¶åï¼Œå®ƒä» EditText è·å–å½“å‰çš„ç¬”è®°å†…å®¹ (noteContent)ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„å†™å…¥è¾“å‡ºæµä¸­ã€‚
æˆåŠŸå†™å…¥åï¼Œæ˜¾ç¤ºâ€œç¬”è®°å¯¼å‡ºæˆåŠŸâ€çš„æç¤ºï¼Œå¦åˆ™æç¤ºç›¸åº”çš„é”™è¯¯ä¿¡æ¯ã€‚

**åŠŸèƒ½æˆªå›¾**

![image](https://github.com/user-attachments/assets/5d5a97e9-e10a-4acd-94e0-997da23c890d) ![image](https://github.com/user-attachments/assets/6c1266c3-4033-4ab0-8f19-d341d5095c1c)

### githubä»“åº“åœ°å€ï¼šhttps://github.com/wenkaicao/NotePad_new-master
### ä½œè€…ï¼šæ›¹æ–‡å‡¯
